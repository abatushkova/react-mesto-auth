(this["webpackJsonpreact-app-auth"]=this["webpackJsonpreact-app-auth"]||[]).push([[0],{15:function(e,t,a){e.exports=a.p+"static/media/fail.4072126c.svg"},24:function(e,t,a){e.exports=a.p+"static/media/logo.5746c0f0.svg"},26:function(e,t,a){e.exports=a.p+"static/media/success.e38b395c.svg"},28:function(e,t,a){e.exports=a(39)},33:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),s=a.n(o),i=a(7),l=(a(33),a(27)),c=a(1),u=a(2),p=a(24),m=a.n(p),d=function(e){var t=Object.assign({},e),a=t.loggedIn,n=t.onSignOut,o=t.email,s=t.path,l=t.link;return r.a.createElement("header",{className:"header page__section"},r.a.createElement("img",{src:m.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u041c\u0435\u0441\u0442\u043e",className:"header__logo"}),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"checkbox",id:"burger-btn",className:"header__burger-checkbox"}),r.a.createElement("label",{className:"header__burger-icon",htmlFor:"burger-btn"},r.a.createElement("span",{className:"header__burger"})),r.a.createElement("nav",{className:"menu"},r.a.createElement("p",{className:"menu__item"},o),r.a.createElement("button",{type:"button",onClick:n,className:"menu__item menu__button"},"\u0412\u044b\u0439\u0442\u0438"))):r.a.createElement(i.b,{className:"header__link",to:s},l))},f=r.a.createContext(null);var h=function(e){var t=e.card,a=e.onCardClick,o=e.onCardLike,s=e.onCardDelete,i=Object(n.useContext)(f),l=t.likes.some((function(e){return e._id===i._id})),c="elements__like-btn ".concat(l&&"elements__like-btn_active"),u=t.owner._id===i._id&&r.a.createElement("button",{type:"button",className:"elements__delete-btn",title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){s(t)}});return r.a.createElement("div",{className:"elements__item"},u,r.a.createElement("img",{src:t.link,alt:t.name,className:"elements__img",onClick:function(){a(t)}}),r.a.createElement("div",{className:"elements__info"},r.a.createElement("h2",{className:"elements__title"},t.name),r.a.createElement("div",{className:"elements__like"},r.a.createElement("button",{type:"button",className:c,title:"\u041c\u043d\u0435 \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){o(t)}}),r.a.createElement("span",{className:"elements__like-counter"},t.likes.length))))};var _=function(e){var t=Object(n.useContext)(f),a=e.onEditAvatar,o=e.onEditProfile,s=e.onAddCard,i=e.onCardClick,l=e.cards,c=e.onCardLike,u=e.onCardDelete;return r.a.createElement("main",{className:"container page__section"},r.a.createElement("section",{className:"profile container__profile"},r.a.createElement("div",{className:"profile__avatar"},r.a.createElement("img",{src:t.avatar,alt:t.name,className:"profile__img"}),r.a.createElement("button",{type:"button",className:"profile__update-av-btn",title:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",onClick:a})),r.a.createElement("div",{className:"profile__details"},r.a.createElement("h1",{className:"profile__name"},t.name),r.a.createElement("button",{type:"button",className:"profile__edit-btn",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:o}),r.a.createElement("p",{className:"profile__info"},t.about)),r.a.createElement("button",{type:"button",className:"profile__add-btn",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044e",onClick:s})),r.a.createElement("section",{className:"elements"},l.map((function(e){return r.a.createElement(h,{key:e._id,card:e,onCardLike:c,onCardClick:i,onCardDelete:u})}))))};var b=function(){return r.a.createElement("footer",{className:"footer page__section"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var v=function(e){return r.a.createElement("button",{type:"button",className:"popup__close-btn",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.closeHandler})};var E=function(e){var t=e.closeHandler,a=e.className,o=e.children,s=Object(n.useRef)(null);Object(n.useEffect)((function(){return document.addEventListener("click",i,!1),document.addEventListener("keydown",l,!1),function(){document.removeEventListener("click",i,!1),document.removeEventListener("keydown",l,!1)}}));var i=function(e){s.current&&!s.current.contains(e.target)&&t()},l=function(e){e.key&&"Escape"===e.key&&t()};return r.a.createElement("div",{className:a,ref:s},o)};var g=function(e){var t=e.name,a=e.title,n=e.isOpen,o=e.onClose,s=e.onSubmit,i=e.children;return n?r.a.createElement("div",{className:"popup popup_type_".concat(t," popup_opened")},r.a.createElement(E,{className:"popup__container",closeHandler:o},r.a.createElement("h2",{className:"popup__title"},a),r.a.createElement("form",{className:"popup__form",name:t,id:"".concat(t,"-form"),noValidate:!0,onSubmit:s},i),r.a.createElement(v,{closeHandler:o}))):r.a.createElement("div",{className:"popup popup_type_".concat(t)})};var C=function(e){var t=e.isDisabled,a=e.children,n="popup__submit-btn ".concat(t?"popup__submit-btn_disabled":"");return r.a.createElement("button",{type:"submit",className:n,disabled:t},a)};var O=function(e){var t=e.isOpen,a=e.onClose,o=e.onUpdateUser,s=Object(n.useContext)(f),i=Object(n.useState)(""),l=Object(c.a)(i,2),u=l[0],p=l[1],m=Object(n.useState)(""),d=Object(c.a)(m,2),h=d[0],_=d[1],b=Object(n.useState)({inputClass:"",errorClass:"",errorMsg:""}),v=Object(c.a)(b,2),E=v[0],O=v[1],j=Object(n.useState)({inputClass:"",errorClass:"",errorMsg:""}),k=Object(c.a)(j,2),N=k[0],y=k[1],S=Object(n.useState)(!0),w=Object(c.a)(S,2),L=w[0],M=w[1],T=Object(n.useState)(!1),x=Object(c.a)(T,2),F=x[0],I=x[1];return Object(n.useEffect)((function(){p(s.name),_(s.about)}),[s]),r.a.createElement(g,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:function(){a(),p(s.name),_(s.about),M(!0),O({inputClass:"",errorClass:"",errorMsg:""}),y({inputClass:"",errorClass:"",errorMsg:""})},onSubmit:function(e){e.preventDefault(),I(!0),o({name:u,about:h}).finally((function(){M(!0),I(!1)}))}},r.a.createElement("label",{className:"popup__label",htmlFor:"name-input"},r.a.createElement("input",{type:"text",name:"name",id:"name-input",className:"popup__input ".concat(E.inputClass),placeholder:"\u0418\u043c\u044f",value:u,onChange:function(e){var t=e.target;p(t.value),t.validity.valid?(O({inputClass:"",errorClass:"",errorMsg:""}),M(!0)):(O({inputClass:"popup__input_type_error",errorClass:"popup__error_visible",errorMsg:t.validationMessage}),M(!1))},pattern:"[a-zA-Z\u0430-\u044f\u0410-\u042f\u0451\u0401\\s-]+",minLength:2,maxLength:40,required:!0}),r.a.createElement("span",{className:"popup__error ".concat(E.errorClass),id:"name-input-error"},E.errorMsg)),r.a.createElement("label",{className:"popup__label",htmlFor:"about-input"},r.a.createElement("input",{type:"text",name:"about",id:"about-input",className:"popup__input ".concat(N.inputClass),placeholder:"\u041e \u0441\u0435\u0431\u0435",value:h,onChange:function(e){var t=e.target;_(t.value),t.validity.valid?(y({inputClass:"",errorClass:"",errorMsg:""}),M(!0)):(y({inputClass:"popup__input_type_error",errorClass:"popup__error_visible",errorMsg:t.validationMessage}),M(!1))},minLength:2,maxLength:200,required:!0}),r.a.createElement("span",{className:"popup__error ".concat(N.errorClass),id:"about-input-error"},N.errorMsg)),r.a.createElement(C,{isDisabled:!L},F?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},j=a(9),k=a(10),N=a(17),y=a(16),S=function(e){Object(N.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).handleChange=function(){var e=n.avatar.current;e.validity.valid?(n.setState({isFormValid:!0}),n.hideInputError()):(n.setState({isFormValid:!1}),n.showInputError(e))},n.showInputError=function(e){n.setState({inputClass:"popup__input_type_error",errorClass:"popup__error_visible",errorMsg:e.validationMessage})},n.hideInputError=function(){n.setState({inputClass:"",errorClass:"",errorMsg:""})},n.handleClose=function(){n.props.onClose(),n.setState({isFormValid:!1}),n.hideInputError()},n.handleSubmit=function(e){e.preventDefault(),n.setState({isLoading:!0}),n.props.onUpdateAvatar({avatar:n.avatar.current.value}).finally((function(){n.setState({isFormValid:!1,isLoading:!1}),n.hideInputError()}))},n.avatar=r.a.createRef(),n.state={inputClass:"",errorClass:"",errorMsg:"",isFormValid:!1,isLoading:!1},n}return Object(k.a)(a,[{key:"render",value:function(){return r.a.createElement(g,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:this.props.isOpen,onClose:this.handleClose,onSubmit:this.handleSubmit},r.a.createElement("label",{className:"popup__label",htmlFor:"avatar-input"},r.a.createElement("input",{type:"url",name:"avatar",className:"popup__input ".concat(this.state.inputClass),id:"avatar-input",ref:this.avatar,onChange:this.handleChange,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430",required:!0}),r.a.createElement("span",{className:"popup__error ".concat(this.state.errorClass),id:"avatar-input-error"},this.state.errorMsg)),r.a.createElement(C,{isDisabled:!this.state.isFormValid},this.state.isLoading?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))}}]),a}(r.a.Component),w=a(11),L=function(e){Object(N.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).handleChange=function(e){var t=n[e.target.name].current,a=t.name,r=Object(w.a)({},n.state.formProps),o=Object(w.a)({},r[a]),s=!0;for(var i in r)s=s&&n[i].current.validity.valid;t.validity.valid?n.hideInputError(o):n.showInputError(t,o),r[a]=o,n.setState({formProps:r,isFormValid:s})},n.showInputError=function(e,t){t.inputClass="popup__input_type_error",t.errorClass="popup__error_visible",t.errorMsg=e.validationMessage},n.hideInputError=function(e){e.inputClass="",e.errorClass="",e.errorMsg=""},n.handleClose=function(){var e=n.state.formProps;for(var t in n.props.onClose(),n.setState({isFormValid:!1}),e)n.hideInputError(e[t])},n.handleSubmit=function(e){e.preventDefault(),n.setState({isLoading:!0});var t=n.state.formProps;n.props.onAddCardSubmit({name:n.title.current.value,link:n.src.current.value}).finally((function(){for(var e in n.setState({isFormValid:!1,isLoading:!1}),t)n.hideInputError(t[e])}))},n.title=r.a.createRef(),n.src=r.a.createRef(),n.state={formProps:{title:{inputClass:"",errorClass:"",errorMsg:""},src:{inputClass:"",errorClass:"",errorMsg:""}},isFormValid:!1,isLoading:!1},n}return Object(k.a)(a,[{key:"render",value:function(){return r.a.createElement(g,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:this.props.isOpen,onClose:this.handleClose,onSubmit:this.handleSubmit},r.a.createElement("label",{className:"popup__label",htmlFor:"title-input"},r.a.createElement("input",{type:"text",name:"title",className:"popup__input ".concat(this.state.formProps.title.inputClass),id:"title-input",ref:this.title,onChange:this.handleChange,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:1,maxLength:30,required:!0}),r.a.createElement("span",{className:"popup__error ".concat(this.state.formProps.title.errorClass),id:"title-input-error"},this.state.formProps.title.errorMsg)),r.a.createElement("label",{className:"popup__label",htmlFor:"src-input"},r.a.createElement("input",{type:"url",name:"src",className:"popup__input ".concat(this.state.formProps.src.inputClass),id:"src-input",ref:this.src,onChange:this.handleChange,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430",required:!0}),r.a.createElement("span",{className:"popup__error ".concat(this.state.formProps.src.errorClass),id:"src-input-error"},this.state.formProps.src.errorMsg)),r.a.createElement(C,{isDisabled:!this.state.isFormValid},this.state.isLoading?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))}}]),a}(r.a.Component);var M=function(e){var t=e.card,a=e.isOpen,n=e.onClose;return r.a.createElement(g,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:a,onClose:n,onSubmit:function(a){a.preventDefault(),e.onCardDeleteConfirm(t._id)}},r.a.createElement(C,null,"\u0414\u0430"))};var T=function(e){var t=e.card,a=e.isOpen,n=e.onClose;return a?r.a.createElement("div",{className:"popup popup_type_img popup_opened"},r.a.createElement(E,{className:"popup__img-wrapper",closeHandler:n},r.a.createElement("img",{src:t.link,alt:t.name,className:"popup__img"}),r.a.createElement("p",{className:"popup__img-title"},t.name),r.a.createElement(v,{closeHandler:n}))):r.a.createElement("div",{className:"popup popup_type_img"})},x=function(e){var t=Object.assign({},e),a=t.loggedIn,n=t.children;return r.a.createElement(u.b,null,(function(){return!0===a?n:r.a.createElement(u.a,{to:"/signin"})}))};var F=function(e){var t=e.name,a=e.title,n=e.buttonText,o=e.link,s=e.onSubmit,l=e.children,c=e.path;return r.a.createElement("div",{className:"book"},r.a.createElement("h2",{className:"book__title"},a),r.a.createElement("form",{className:"book__form",name:t,noValidate:!0,onSubmit:s},r.a.createElement("div",{className:"book__content"},l),r.a.createElement("button",{type:"submit",className:"book__button"},n)),r.a.createElement(i.b,{to:c,className:"book__link"},o))};var I=function(e){var t=e.infoData,a=e.isOpen,n=e.onClose;return a?r.a.createElement("div",{className:"popup popup_type_info popup_opened"},r.a.createElement(E,{className:"popup__container popup__container_type_info",closeHandler:n},r.a.createElement("img",{src:t.src,alt:t.alt,className:"popup__info-sign"}),r.a.createElement("p",{className:"popup__info-title"},t.text),r.a.createElement(v,{closeHandler:n}))):r.a.createElement("div",{className:"popup popup_type_info"})},P=a(15),D=a.n(P),A=a(26),U=a.n(A),V=function(e){var t=e.onLogin,a=e.isTooltipOpen,o=e.onTooltipClose,s=Object(n.useState)(""),i=Object(c.a)(s,2),l=i[0],u=i[1],p=Object(n.useState)(""),m=Object(c.a)(p,2),f=m[0],h=m[1],_=Object(n.useState)({text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",alt:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e",src:U.a}),b=Object(c.a)(_,2),v=b[0],E=b[1],g=function(){return E({text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",alt:"\u041e\u0448\u0438\u0431\u043a\u0430",src:D.a})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,{infoData:v,isOpen:a,onClose:o}),r.a.createElement(d,{link:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",path:"/signup"}),r.a.createElement(F,{name:"login",title:"\u0412\u0445\u043e\u0434",buttonText:"\u0412\u043e\u0439\u0442\u0438",link:"\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",onSubmit:function(e){e.preventDefault(),l&&f||g(),t({email:l,password:f}).then((function(e){e||(u(""),h(""),g())})).catch((function(e){return console.error(e)}))},path:"/signup"},r.a.createElement("label",{className:"book__label",htmlFor:"email"},r.a.createElement("input",{type:"email",name:"email",id:"email",className:"book__input",placeholder:"Email",value:l,onChange:function(e){return u(e.target.value)},required:!0})),r.a.createElement("label",{className:"book__label",htmlFor:"password"},r.a.createElement("input",{type:"password",name:"password",id:"password",className:"book__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:f,onChange:function(e){return h(e.target.value)},required:!0}))))},H=function(e){var t=e.onRegister,a=e.isTooltipOpen,o=e.onTooltipClose,s=Object(n.useState)(""),i=Object(c.a)(s,2),l=i[0],p=i[1],m=Object(n.useState)(""),f=Object(c.a)(m,2),h=f[0],_=f[1],b=Object(n.useState)({}),v=Object(c.a)(b,2),E=v[0],g=v[1],C=Object(u.g)();return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,{infoData:E,isOpen:a,onClose:o}),r.a.createElement(d,{link:"\u0412\u043e\u0439\u0442\u0438",path:"/signin"}),r.a.createElement(F,{name:"book",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",link:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438",onSubmit:function(e){e.preventDefault(),t({email:l,password:h}).then((function(e){if(e)return C.push("/signin");p(""),_(""),g({text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",alt:"\u041e\u0448\u0438\u0431\u043a\u0430",src:D.a})})).catch((function(e){return console.error(e)}))},path:"/signin"},r.a.createElement("label",{className:"book__label",htmlFor:"email"},r.a.createElement("input",{type:"email",name:"email",id:"email",className:"book__input",placeholder:"Email",value:l,onChange:function(e){return p(e.target.value)},required:!0})),r.a.createElement("label",{className:"book__label",htmlFor:"password"},r.a.createElement("input",{type:"password",name:"password",id:"password",className:"book__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:h,onChange:function(e){return _(e.target.value)},required:!0}))))},q="https://auth.nomoreparties.co",R=new(function(){function e(t){Object(j.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(k.a)(e,[{key:"_fetch",value:function(e,t){return fetch(this._baseUrl+e,Object(w.a)(Object(w.a)({},t),{},{headers:this._headers,body:JSON.stringify(t.body)})).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._fetch("/users/me",{method:"GET"})}},{key:"getCardList",value:function(){return this._fetch("/cards",{method:"GET"})}},{key:"postCard",value:function(e){var t=e.name,a=e.link;return this._fetch("/cards",{method:"POST",body:{name:t,link:a}})}},{key:"changeCardLikeStatus",value:function(e,t){return this._fetch("/cards/likes/"+e,{method:t?"PUT":"DELETE"})}},{key:"deleteCard",value:function(e){return this._fetch("/cards/"+e,{method:"DELETE"})}},{key:"setUserInfo",value:function(e){var t=e.name,a=e.about;return this._fetch("/users/me",{method:"PATCH",body:{name:t,about:a}})}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return this._fetch("/users/me/avatar",{method:"PATCH",body:{avatar:t}})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",headers:{authorization:"bd0f2499-7585-4f83-9366-da3fa3857f94","Content-Type":"application/json"}}),J=function(){var e=Object(n.useState)(null),t=Object(c.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),i=Object(c.a)(s,2),p=i[0],m=i[1],h=Object(n.useState)(!1),v=Object(c.a)(h,2),E=v[0],g=v[1],C=Object(n.useState)(!1),j=Object(c.a)(C,2),k=j[0],N=j[1],y=Object(n.useState)(!1),w=Object(c.a)(y,2),F=w[0],I=w[1],P=Object(n.useState)(!1),D=Object(c.a)(P,2),A=D[0],U=D[1],J=Object(n.useState)(!1),z=Object(c.a)(J,2),B=z[0],G=z[1],W=Object(n.useState)(null),Z=Object(c.a)(W,2),$=Z[0],K=Z[1],Q=Object(n.useState)([]),X=Object(c.a)(Q,2),Y=X[0],ee=X[1],te=Object(n.useState)(!1),ae=Object(c.a)(te,2),ne=ae[0],re=ae[1],oe=Object(n.useState)(""),se=Object(c.a)(oe,2),ie=se[0],le=se[1],ce=Object(u.g)();Object(n.useEffect)((function(){Promise.all([localStorage.getItem("token"),R.getUserInfo(),R.getCardList()]).then((function(e){var t=Object(c.a)(e,3),a=t[0],n=t[1],r=t[2];a&&function(e){return fetch("".concat(q,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.error(e)}))}(a).then((function(e){e&&(le(e.data.email),re(!0),ce.push("/"))})),o(n),ee(r)})).catch((function(e){return console.error(e)}))}),[]);var ue=function(){m(!1),g(!1),N(!1),I(!1),U(!1),G(!1),K(null)};return a?r.a.createElement("div",{className:"page__content"},r.a.createElement(u.d,null,r.a.createElement(x,{exact:!0,path:"/",loggedIn:ne},r.a.createElement(f.Provider,{value:a},r.a.createElement(d,{onSignOut:function(){localStorage.removeItem("token"),ce.push("/signin")},email:ie,loggedIn:ne}),r.a.createElement(_,{onEditAvatar:function(){m(!0)},onEditProfile:function(){g(!0)},onAddCard:function(){N(!0)},onCardClick:function(e){K(e),I(!0)},cards:Y,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===a._id}));return R.changeCardLikeStatus(e._id,!t).then((function(t){var a=Y.map((function(a){return a._id===e._id?t:a}));ee(a)})).catch((function(e){return console.error(e)}))},onCardDelete:function(e){K(e),U(!0)}}),r.a.createElement(S,{isOpen:p,onClose:ue,onUpdateAvatar:function(e){var t=e.avatar;return R.setUserAvatar({avatar:t}).then((function(e){o(e),ue()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(O,{isOpen:E,onClose:ue,onUpdateUser:function(e){var t=e.name,a=e.about;return R.setUserInfo({name:t,about:a}).then((function(e){o(e),ue()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(L,{isOpen:k,onClose:ue,onAddCardSubmit:function(e){var t=e.name,a=e.link;return R.postCard({name:t,link:a}).then((function(e){ee([e].concat(Object(l.a)(Y))),ue()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(M,{card:$,isOpen:A,onClose:ue,onCardDeleteConfirm:function(e){return R.deleteCard(e).then((function(t){var a=Y.filter((function(a){return a._id===e?null:t}));ee(a),ue()})).catch((function(e){return console.error(e)}))}}),r.a.createElement(T,{card:$,isOpen:F,onClose:ue}))),r.a.createElement(u.b,{path:"/signin"},r.a.createElement(V,{onLogin:function(e){var t=e.email,a=e.password;return function(e){var t=e.email,a=e.password;return fetch("".concat(q,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("token",e.token),e})).catch((function(e){return console.error(e)}))}({email:t,password:a}).then((function(e){return e&&e.token?(le(t),re(!0),ce.push("/"),!0):(G(!0),Promise.reject(new Error("on Sign in")))})).catch((function(e){return console.error(e)}))},isTooltipOpen:B,onTooltipClose:ue})),r.a.createElement(u.b,{path:"/signup"},r.a.createElement(H,{onRegister:function(e){return function(e){var t=e.password,a=e.email;return fetch("".concat(q,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:t,email:a})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.error(e)}))}({email:e.email,password:e.password}).then((function(e){return e.data?(le(e.data.email),G(!0),!0):(G(!0),Promise.reject(new Error("on Sign up")))})).catch((function(e){return console.error(e)}))},isTooltipOpen:B,onTooltipClose:ue}))),r.a.createElement(b,null)):null};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{basename:"/react-mesto-auth"},r.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.1012a4b2.chunk.js.map